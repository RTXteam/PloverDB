[uwsgi]

module = app.main
callable = app
uid = plover
gid = plover
buffer-size = 65535
post-buffering = 32768
logto = /var/log/uwsgi.log
max-requests = 100
harakiri = 90
min-worker-lifetime = 5
max-worker-lifetime = 14400
max-worker-lifetime-delta = 60
skip-atexit-teardown = true
skip-atexit = true

# =============================================================================
# REQUIRED ADDITIONS FOR PYTHON 3.12 (migrating from tiangolo python:3.11)
# The tiangolo/uwsgi-nginx-flask image provided these settings automatically.
# With vanilla python:3.12 base image, we must set them explicitly.
# =============================================================================

# Socket: tiangolo used nginx+unix socket internally; we serve HTTP directly
http-socket = 0.0.0.0:80

# Master process: required for worker management (tiangolo set this internally)
master = true

# These were set via environment variables in tiangolo; now in CMD
# processes = 16      (set via: --processes ${UWSGI_PROCESSES:-16} in Dockerfile CMD)
# cheaper = 8         (set via: --cheaper ${UWSGI_CHEAPER:-8} in Dockerfile CMD)

# Graceful shutdown (from tiangolo's uwsgi.ini)
die-on-term = true
need-app = true
